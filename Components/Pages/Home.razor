@page "/"
@rendermode InteractiveServer
@using System.ComponentModel.DataAnnotations

<PageTitle>M0K0's GA</PageTitle>
<h2>A genetic algorithm in C# and Blazor</h2>

<p>
_________SETTINGS___________ 
<div>
	<label for="goal">goal:</label>
	<input id="goal" @bind="goal"/>
</div>
<div>
	<label for="solution_space">solutionspace:</label>
	<input id="solution_space" @bind="solution_space"/>
</div>
<div>
	<label for="population_size">populationsize:</label>
	<input id="population_size" @bind="population_size"/>
</div>
<div>
	<label for="generations">iterations</label>
	<input id="generations" @bind="generations"/>
</div>
	<button @onclick="evolve">evolve Population</button>
</p>
<p>
	<div>
	POPULATION:
	</div>
	<div>
	Generation @counter
	</div>
</p>


@foreach(Genome g in individuals)
{
<li>@g.score =[@g.get_dna()]</li>
}

@code
{
	public int fitnes_function(Genome g)
	{
		int score = 0;
		var dna = g.genetic_material;
		for(int i = 0 ; i < dna.Count()-1 ; i++)
		{
			if(dna[i] == goal[i])
			{
				score++;
			}
		}
		return score;
	}
}

@code
{
	List<string> genome_data {get;set;} = new List<string>();
	List<Genome> individuals = new List<Genome>();
	string solution_space {get;set;} = String.Empty;
	string goal {get;set;} = String.Empty;
	Population pop = new Population("",0,0);
	int population_size {get; set;} = 0;
	int generations {get;set;} = 0;
	int counter  = 0;


	void evolve()
	{
		pop = new Population(solution_space,goal.Length,population_size);
		pop.init(population_size);
		counter = 0;

		for (int x=0;x<generations;x++)
		{
			pop.evaluate(fitnes_function);
			pop.roulette_wheel_selection();
			counter++;

		foreach(Genome genome in pop.all_genomes)
		{
			genome.mutate(20);
		}	
		}

		individuals = pop.all_genomes;	
	}
}

